<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Universal Video Downloader | Download from YouTube, TikTok, Facebook, Instagram</title>
<meta name="description" content="Free online video downloader for YouTube, TikTok, Instagram, Facebook and more. Download videos in HD quality without registration.">

<style>
  :root{
    --primary:#4285f4;
    --primary-600:#3367d6;
    --success:#27c07d;
    --success-600:#1fa169;
    --danger:#ea4335;
    --ink:#202124;
    --muted:#6b7280;
    --bg:#f8f9fa;
    --card:#ffffff;
    --ring:#cfe2ff;
  }

  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;background:var(--bg);color:var(--ink);line-height:1.6}

  /* Header */
  header{position:sticky;top:0;z-index:50;background:var(--card);box-shadow:0 2px 10px rgba(0,0,0,.06)}
  .container{max-width:1200px;margin:0 auto;padding:0 20px}
  .nav{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
  .logo{font-weight:800;font-size:22px;color:var(--primary);text-decoration:none}
  .logo span{color:var(--danger)}
  .links{display:flex;gap:18px}
  .links a{color:var(--ink);text-decoration:none;font-weight:600;opacity:.8}
  .links a:hover{opacity:1}

  /* Hero */
  .hero{padding:42px 0;text-align:center}
  .hero h1{font-size:32px;margin-bottom:8px}
  .hero p{max-width:780px;margin:0 auto 24px;color:#666}

  /* Form card */
  .card{background:var(--card);border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.06);padding:22px;max-width:900px;margin:0 auto}
  .input-row{display:flex;gap:10px}
  .input-row input[type="url"]{flex:1;padding:14px 16px;border:1px solid #e5e7eb;border-radius:10px;font-size:16px;outline:none}
  .input-row input[type="url"]:focus{border-color:var(--primary)}
  .btn{border:none;border-radius:10px;padding:0 22px;cursor:pointer;font-weight:700;color:#fff;background:var(--primary);min-height:48px}
  .btn:hover{background:var(--primary-600)}

  /* Result panel (like your screenshot) */
  .result{margin-top:18px;display:none}
  .result.show{display:block}
  .pane{display:flex;gap:18px;align-items:flex-start;background:#fff;border-radius:14px;padding:16px;border:1px solid #eef2f7}
  .thumb{width:280px;max-width:40%;border-radius:12px;object-fit:cover;aspect-ratio:16/9;background:#e5e7eb}
  .meta{flex:1;min-width:0}
  .title{font-size:20px;font-weight:800;margin-bottom:6px;word-break:break-word}
  .submeta{color:var(--muted);font-size:14px;margin-bottom:14px}

  .action-row{display:flex;gap:14px;margin-bottom:10px;flex-wrap:wrap}
  .pill{border:none;cursor:pointer;font-weight:800;color:#fff;padding:14px 22px;border-radius:9999px;display:flex;align-items:center;gap:8px}
  .pill.mp3{background:var(--success)}
  .pill.mp3:hover{background:var(--success-600)}
  .pill.mp4{background:var(--primary)}
  .pill.mp4:hover{background:var(--primary-600)}

  .quality-wrap{display:flex;align-items:center;gap:14px;flex-wrap:wrap}
  .quality-label{font-weight:700}
  .quality-link{color:var(--primary);text-decoration:none;font-weight:800}
  .select{appearance:none;padding:12px 14px;border-radius:12px;border:2px solid var(--ring);background:#fff;font-weight:700}
  .select:focus{outline:none;border-color:var(--primary)}

  /* Platform icons row (cosmetic) */
  .platforms{display:flex;justify-content:center;gap:20px;margin-top:16px}
  .platform{width:54px;height:54px;background:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 6px 14px rgba(0,0,0,.08)}
  .platform img{width:28px;height:28px}

  /* States */
  .loading{display:flex;align-items:center;justify-content:center;gap:10px;padding:26px}
  .spinner{width:32px;height:32px;border-radius:50%;border:4px solid rgba(66,133,244,.25);border-top-color:var(--primary);animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  .error{background:#ffebee;color:#c62828;padding:16px;border-radius:10px;border:1px solid #ffcdd2;margin-top:14px;text-align:center}

  .toast{position:fixed;right:20px;bottom:20px;background:var(--success);color:#fff;font-weight:700;padding:14px 16px;border-radius:10px;box-shadow:0 10px 24px rgba(0,0,0,.18);animation:slideIn .25s ease}
  @keyframes slideIn{from{transform:translateX(16px);opacity:0}to{transform:translateX(0);opacity:1}}

  @media (max-width:900px){
    .pane{flex-direction:column}
    .thumb{width:100%;max-width:100%}
    .action-row{justify-content:space-between}
  }
</style>
</head>
<body>

<header>
  <div class="container">
    <div class="nav">
      <a class="logo" href="#">Universal<span>Downloader</span></a>
      <div class="links">
        <a href="#how">How It Works</a>
        <a href="#features">Features</a>
        <a href="#faq">FAQ</a>
      </div>
    </div>
  </div>
</header>

<section class="hero">
  <div class="container">
    <h1>Download Videos from Any Platform</h1>
    <p>Paste a video link. Choose your quality. Download as MP4 or extract audio as MP3.</p>

    <div class="card">
      <form id="downloadForm">
        <div class="input-row">
          <input id="videoUrl" type="url" placeholder="Paste video link (YouTube, TikTok, Facebook, Instagram, ...)" required/>
          <button class="btn" type="submit">Get Video</button>
        </div>
      </form>

      <!-- Result panel -->
      <div id="result" class="result">
        <div class="pane">
          <img id="thumb" class="thumb" alt="Thumbnail"/>
          <div class="meta">
            <div id="title" class="title">‚Äî</div>
            <div id="submeta" class="submeta">Unknown ‚Ä¢ Unknown views ‚Ä¢ Unknown</div>

            <div class="action-row">
              <button id="btnMp3" class="pill mp3">üéµ Download MP3</button>
              <button id="btnMp4" class="pill mp4">üìπ Download MP4</button>
            </div>

            <div class="quality-wrap">
              <div class="quality-label">
                Quality:
                <a id="qualityLink" href="javascript:void(0)" class="quality-link">‚Äî</a>
              </div>
              <select id="qualitySelect" class="select" aria-label="Choose quality"></select>
            </div>
          </div>
        </div>
      </div>

      <!-- Loading + error containers -->
      <div id="state"></div>
    </div>

    <div class="platforms">
      <div class="platform" title="YouTube"><img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png"/></div>
      <div class="platform" title="TikTok"><img src="https://cdn-icons-png.flaticon.com/512/3046/3046126.png"/></div>
      <div class="platform" title="Facebook"><img src="https://cdn-icons-png.flaticon.com/512/124/124010.png"/></div>
      <div class="platform" title="Instagram"><img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png"/></div>
    </div>
  </div>
</section>

<!-- ...existing code above... -->
<script>
(() => {
  const form = document.getElementById('downloadForm');
  const input = document.getElementById('videoUrl');
  const stateBox = document.getElementById('state');
  const result = document.getElementById('result');
  const thumb = document.getElementById('thumb');
  const titleEl = document.getElementById('title');
  const qualitySelect = document.getElementById('qualitySelect');
  const btnMp3 = document.getElementById('btnMp3');
  const btnMp4 = document.getElementById('btnMp4');

  let currentVideo = null;
  let selectedVideoFormat = null;

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const url = input.value.trim();
    clearState();
    hideResult();

    if (!isValidUrl(url)) {
      showError('Please enter a valid video URL.');
      return;
    }

    showLoading('Analyzing video link...');
    try {
      const info = await fetchVideoInfo(url);
      currentVideo = { ...info, url };
      renderResult(info);
      clearState();
    } catch (err) {
      showError('Failed to process video: ' + (err?.message || 'Unknown error'));
      console.error(err);
    }
  });

  function isValidUrl(s) {
    try { new URL(s); return true; } catch { return false; }
  }

  async function fetchVideoInfo(url) {
    const infoRes = await fetch('/api/download/info', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ url })
    });
    if (!infoRes.ok) throw new Error((await infoRes.json()).error || 'Failed to fetch video info');
    return await infoRes.json();
  }

  function renderResult(info) {
  thumb.src = info.thumbnail || '';
  titleEl.textContent = info.title || 'Video';

  // Only show video formats up to 2160p (4K)
  const videoFormats = info.formats
    .filter(f => f.type.startsWith('video/') && (!f.height || f.height <= 2160))
    .sort((a, b) => (b.height || 0) - (a.height || 0));

  qualitySelect.innerHTML = videoFormats.map(f =>
    `<option value="${f.id}" data-type="${f.type}" data-label="${f.display}">${f.display} ${f.codec ? `‚Ä¢ ${f.codec}` : ''} ${f.fps ? `‚Ä¢ ${f.fps}fps` : ''}</option>`
  ).join('');

  selectedVideoFormat = videoFormats[0];
  qualitySelect.value = selectedVideoFormat.id;

  qualitySelect.onchange = () => {
    const id = qualitySelect.value;
    const found = videoFormats.find(f => f.id === id);
    if (found) selectedVideoFormat = found;
  };

  btnMp3.onclick = () => handleDownload('audio');
  btnMp4.onclick = () => handleDownload('video');

  showResult();
}

  async function handleDownload(kind) {
    if (!currentVideo) return;
    setBusy(btnMp3, true);
    setBusy(btnMp4, true);

    try {
      let fmt;
      if (kind === 'audio') {
        fmt = currentVideo.formats.find(f => f.type.startsWith('audio/')) || { id: 'bestaudio', type: 'audio/mp3' };
      } else {
        fmt = selectedVideoFormat;
      }
      if (!fmt) throw new Error('No format selected');

      // Create a hidden form and submit to backend for download
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = '/api/download';
      form.style.display = 'none';

      const urlInput = document.createElement('input');
      urlInput.name = 'url';
      urlInput.value = currentVideo.url;
      form.appendChild(urlInput);

      const qualityInput = document.createElement('input');
      qualityInput.name = 'quality';
      qualityInput.value = fmt.id;
      form.appendChild(qualityInput);

      const formatInput = document.createElement('input');
      formatInput.name = 'format';
      formatInput.value = fmt.type.split('/')[1];
      form.appendChild(formatInput);

      document.body.appendChild(form);
      form.submit();
      document.body.removeChild(form);

      showToast('Download started!');
    } catch (err) {
      showError('Download failed: ' + (err?.message || 'Unknown error'));
      console.error(err);
    } finally {
      setBusy(btnMp3, false);
      setBusy(btnMp4, false);
    }
  }

  function showLoading(msg) {
    stateBox.innerHTML = `<div class="loading"><div class="spinner"></div><div>${msg}</div></div>`;
  }
  function clearState() { stateBox.innerHTML = ''; }
  function showError(text) {
    stateBox.innerHTML = `<div class="error"><strong>‚ö†Ô∏è Error:</strong> ${text}</div>`;
  }
  function showToast(text) {
    const el = document.createElement('div');
    el.className = 'toast';
    el.textContent = text;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 3000);
  }
  function setBusy(button, on) {
    button.disabled = on;
    if (on) {
      const label = button.textContent;
      button.dataset.label = label;
      button.textContent = 'Preparing...';
    } else {
      button.textContent = button.dataset.label || button.textContent;
    }
  }
  function showResult() { result.classList.add('show'); }
  function hideResult() { result.classList.remove('show'); }
})();
</script>
<!-- ...existing code below... -->

</body>
</html>
